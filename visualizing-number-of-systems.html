<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>13 Visualizing Number of Systems | Tidy Hurricanes</title>
  <meta name="description" content="<p>This manuscript describes various examples for how to use Tidyverse tools to
perform an exploratory analysis of storms and hurricanes in the North Atlantic.</p>" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="13 Visualizing Number of Systems | Tidy Hurricanes" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://www.gastonsanchez.com/R-tidy-hurricanes/images/R-tidy-hurricanes-cover.png" />
  <meta property="og:description" content="<p>This manuscript describes various examples for how to use Tidyverse tools to
perform an exploratory analysis of storms and hurricanes in the North Atlantic.</p>" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="13 Visualizing Number of Systems | Tidy Hurricanes" />
  
  <meta name="twitter:description" content="<p>This manuscript describes various examples for how to use Tidyverse tools to
perform an exploratory analysis of storms and hurricanes in the North Atlantic.</p>" />
  <meta name="twitter:image" content="https://www.gastonsanchez.com/R-tidy-hurricanes/images/R-tidy-hurricanes-cover.png" />

<meta name="author" content="Gaston Sanchez" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="counting-tropical-systems.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><b>Tidy Hurricanes</b><br><small>Gaston Sanchez</small></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#my-series-of-r-tutorials"><i class="fa fa-check"></i>My Series of R Tutorials</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#donation"><i class="fa fa-check"></i>Donation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="tables-and-tidyverse.html"><a href="tables-and-tidyverse.html"><i class="fa fa-check"></i><b>1</b> Tables and Tidyverse</a>
<ul>
<li class="chapter" data-level="" data-path="tables-and-tidyverse.html"><a href="tables-and-tidyverse.html#installing-tidyverse"><i class="fa fa-check"></i>Installing Tidyverse</a></li>
<li class="chapter" data-level="" data-path="tables-and-tidyverse.html"><a href="tables-and-tidyverse.html#a-bit-about-tidyverse"><i class="fa fa-check"></i>A bit about Tidyverse</a></li>
<li class="chapter" data-level="" data-path="tables-and-tidyverse.html"><a href="tables-and-tidyverse.html#note"><i class="fa fa-check"></i>Note</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tropical-storms.html"><a href="tropical-storms.html"><i class="fa fa-check"></i><b>2</b> Tropical Storms and Hurricanes</a>
<ul>
<li class="chapter" data-level="2.1" data-path="tropical-storms.html"><a href="tropical-storms.html#a-little-bit-about-hurricanes"><i class="fa fa-check"></i><b>2.1</b> A little bit about Hurricanes</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="tropical-storms.html"><a href="tropical-storms.html#tropical-cyclones"><i class="fa fa-check"></i><b>2.1.1</b> Tropical Cyclones</a></li>
<li class="chapter" data-level="2.1.2" data-path="tropical-storms.html"><a href="tropical-storms.html#storm-classification"><i class="fa fa-check"></i><b>2.1.2</b> Storm Classification</a></li>
<li class="chapter" data-level="2.1.3" data-path="tropical-storms.html"><a href="tropical-storms.html#naming-storms"><i class="fa fa-check"></i><b>2.1.3</b> Naming Storms</a></li>
<li class="chapter" data-level="2.1.4" data-path="tropical-storms.html"><a href="tropical-storms.html#atlantic-hurricane-season"><i class="fa fa-check"></i><b>2.1.4</b> Atlantic Hurricane Season</a></li>
<li class="chapter" data-level="2.1.5" data-path="tropical-storms.html"><a href="tropical-storms.html#storm-formation"><i class="fa fa-check"></i><b>2.1.5</b> Storm Formation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="storms.html"><a href="storms.html"><i class="fa fa-check"></i><b>3</b> Data Set <code>storms</code></a>
<ul>
<li class="chapter" data-level="3.1" data-path="storms.html"><a href="storms.html#atlantic-hurricane-data"><i class="fa fa-check"></i><b>3.1</b> Atlantic Hurricane Data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="storms.html"><a href="storms.html#data-storms"><i class="fa fa-check"></i><b>3.1.1</b> Data <code>storms</code></a></li>
<li class="chapter" data-level="3.1.2" data-path="storms.html"><a href="storms.html#storms-documentation"><i class="fa fa-check"></i><b>3.1.2</b> <code>storms</code> Documentation</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="storms.html"><a href="storms.html#general-inspection"><i class="fa fa-check"></i><b>3.2</b> General Inspection</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="single-columns.html"><a href="single-columns.html"><i class="fa fa-check"></i><b>4</b> Inspecting Single Columns</a>
<ul>
<li class="chapter" data-level="4.1" data-path="single-columns.html"><a href="single-columns.html#basic-inspection-of-year"><i class="fa fa-check"></i><b>4.1</b> Basic Inspection of Year</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="single-columns.html"><a href="single-columns.html#barplot-of-year-values"><i class="fa fa-check"></i><b>4.1.1</b> Barplot of <code>year</code> values</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="single-columns.html"><a href="single-columns.html#basic-inspection-of-month"><i class="fa fa-check"></i><b>4.2</b> Basic inspection of <code>month</code></a></li>
<li class="chapter" data-level="4.3" data-path="single-columns.html"><a href="single-columns.html#your-turn"><i class="fa fa-check"></i><b>4.3</b> Your Turn</a></li>
</ul></li>
<li class="part"><span><b>II Analyzing Storms in 1975</b></span></li>
<li class="chapter" data-level="5" data-path="storms-in-1975.html"><a href="storms-in-1975.html"><i class="fa fa-check"></i><b>5</b> Storms in 1975</a>
<ul>
<li class="chapter" data-level="5.1" data-path="storms-in-1975.html"><a href="storms-in-1975.html#visualizing-1975-data"><i class="fa fa-check"></i><b>5.1</b> Visualizing 1975 data</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="storms-in-1975.html"><a href="storms-in-1975.html#histograms"><i class="fa fa-check"></i><b>5.1.1</b> Histograms</a></li>
<li class="chapter" data-level="5.1.2" data-path="storms-in-1975.html"><a href="storms-in-1975.html#boxplots"><i class="fa fa-check"></i><b>5.1.2</b> Boxplots</a></li>
<li class="chapter" data-level="5.1.3" data-path="storms-in-1975.html"><a href="storms-in-1975.html#density-curves"><i class="fa fa-check"></i><b>5.1.3</b> Density Curves</a></li>
<li class="chapter" data-level="5.1.4" data-path="storms-in-1975.html"><a href="storms-in-1975.html#facets"><i class="fa fa-check"></i><b>5.1.4</b> Facets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="storm-amy-1975.html"><a href="storm-amy-1975.html"><i class="fa fa-check"></i><b>6</b> Storm Amy (1975)</a>
<ul>
<li class="chapter" data-level="6.1" data-path="storm-amy-1975.html"><a href="storm-amy-1975.html#exploring-wind"><i class="fa fa-check"></i><b>6.1</b> Exploring <code>wind</code></a></li>
<li class="chapter" data-level="6.2" data-path="storm-amy-1975.html"><a href="storm-amy-1975.html#exploring-pressure"><i class="fa fa-check"></i><b>6.2</b> Exploring <code>pressure</code></a></li>
<li class="chapter" data-level="6.3" data-path="storm-amy-1975.html"><a href="storm-amy-1975.html#your-turn-1"><i class="fa fa-check"></i><b>6.3</b> Your Turn</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="summarizing-1975-data.html"><a href="summarizing-1975-data.html"><i class="fa fa-check"></i><b>7</b> Summarizing 1975 Data</a>
<ul>
<li class="chapter" data-level="7.1" data-path="summarizing-1975-data.html"><a href="summarizing-1975-data.html#group-by-operations"><i class="fa fa-check"></i><b>7.1</b> Group-by Operations</a></li>
<li class="chapter" data-level="7.2" data-path="summarizing-1975-data.html"><a href="summarizing-1975-data.html#arrange-operations"><i class="fa fa-check"></i><b>7.2</b> Arrange operations</a></li>
<li class="chapter" data-level="7.3" data-path="summarizing-1975-data.html"><a href="summarizing-1975-data.html#further-inspection-of-1975-storm-amy"><i class="fa fa-check"></i><b>7.3</b> Further inspection of 1975 storm Amy</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="summarizing-1975-data.html"><a href="summarizing-1975-data.html#your-turn-2"><i class="fa fa-check"></i><b>7.3.1</b> Your Turn</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="piper.html"><a href="piper.html"><i class="fa fa-check"></i><b>8</b> The Pipe Operator</a>
<ul>
<li class="chapter" data-level="8.1" data-path="piper.html"><a href="piper.html#piping"><i class="fa fa-check"></i><b>8.1</b> Piping</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="piper.html"><a href="piper.html#the-magrittr-operator"><i class="fa fa-check"></i><b>8.1.1</b> The <code>magrittr</code> operator</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="basic-maps.html"><a href="basic-maps.html"><i class="fa fa-check"></i><b>9</b> Basic Maps</a>
<ul>
<li class="chapter" data-level="9.1" data-path="basic-maps.html"><a href="basic-maps.html#graphing-maps"><i class="fa fa-check"></i><b>9.1</b> Graphing Maps</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="basic-maps.html"><a href="basic-maps.html#plotting-location-of-storm-records"><i class="fa fa-check"></i><b>9.1.1</b> Plotting location of storm records</a></li>
<li class="chapter" data-level="9.1.2" data-path="basic-maps.html"><a href="basic-maps.html#basic-map"><i class="fa fa-check"></i><b>9.1.2</b> Basic map</a></li>
<li class="chapter" data-level="9.1.3" data-path="basic-maps.html"><a href="basic-maps.html#mapping-1975-storms"><i class="fa fa-check"></i><b>9.1.3</b> Mapping 1975 Storms</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="less-basic-maps.html"><a href="less-basic-maps.html"><i class="fa fa-check"></i><b>10</b> Less Basic Maps</a>
<ul>
<li class="chapter" data-level="10.1" data-path="less-basic-maps.html"><a href="less-basic-maps.html#more-mapping-approaches"><i class="fa fa-check"></i><b>10.1</b> More mapping approaches</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="less-basic-maps.html"><a href="less-basic-maps.html#storms-from-1975-to-1980"><i class="fa fa-check"></i><b>10.1.1</b> Storms from 1975 to 1980</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>11</b> Summary</a>
<ul>
<li class="chapter" data-level="11.1" data-path="summary.html"><a href="summary.html#number-of-storms-per-year"><i class="fa fa-check"></i><b>11.1</b> Number of Storms per Year</a></li>
<li class="chapter" data-level="11.2" data-path="summary.html"><a href="summary.html#your-turn-3"><i class="fa fa-check"></i><b>11.2</b> Your Turn</a></li>
</ul></li>
<li class="part"><span><b>III Analyzing Storms 1975-2020</b></span></li>
<li class="chapter" data-level="12" data-path="counting-tropical-systems.html"><a href="counting-tropical-systems.html"><i class="fa fa-check"></i><b>12</b> Counting Tropical Systems</a></li>
<li class="chapter" data-level="13" data-path="visualizing-number-of-systems.html"><a href="visualizing-number-of-systems.html"><i class="fa fa-check"></i><b>13</b> Visualizing Number of Systems</a>
<ul>
<li class="chapter" data-level="13.1" data-path="visualizing-number-of-systems.html"><a href="visualizing-number-of-systems.html#barcharts"><i class="fa fa-check"></i><b>13.1</b> Barcharts</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="visualizing-number-of-systems.html"><a href="visualizing-number-of-systems.html#barchart-with-geom_bar"><i class="fa fa-check"></i><b>13.1.1</b> Barchart with <code>geom_bar()</code></a></li>
<li class="chapter" data-level="13.1.2" data-path="visualizing-number-of-systems.html"><a href="visualizing-number-of-systems.html#barchart-with-geom_col"><i class="fa fa-check"></i><b>13.1.2</b> Barchart with <code>geom_col()</code></a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="visualizing-number-of-systems.html"><a href="visualizing-number-of-systems.html#customizing-a-barchart"><i class="fa fa-check"></i><b>13.2</b> Customizing a Barchart</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="visualizing-number-of-systems.html"><a href="visualizing-number-of-systems.html#global-versus-local-aesthetic-mappings"><i class="fa fa-check"></i><b>13.2.1</b> Global versus Local Aesthetic Mappings</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://www.gastonsanchez.com" target="blank">gastonsanchez.com</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tidy Hurricanes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="visualizing-number-of-systems" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">13</span> Visualizing Number of Systems<a href="visualizing-number-of-systems.html#visualizing-number-of-systems" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>We ended the preceding chapter with the following command that allows us to
get the number of tropical systems in each year from 1975 to 2020:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="visualizing-number-of-systems.html#cb1-1" aria-hidden="true" tabindex="-1"></a>system_counts_per_year <span class="ot">&lt;-</span> storms <span class="sc">%&gt;%</span> </span>
<span id="cb1-2"><a href="visualizing-number-of-systems.html#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(year, name) <span class="sc">%&gt;%</span> </span>
<span id="cb1-3"><a href="visualizing-number-of-systems.html#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(year)</span>
<span id="cb1-4"><a href="visualizing-number-of-systems.html#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="visualizing-number-of-systems.html#cb1-5" aria-hidden="true" tabindex="-1"></a>system_counts_per_year</span></code></pre></div>
<pre><code>## # A tibble: 46 × 2
##     year     n
##    &lt;dbl&gt; &lt;int&gt;
##  1  1975     3
##  2  1976     2
##  3  1977     3
##  4  1978     4
##  5  1979     7
##  6  1980     8
##  7  1981     5
##  8  1982     5
##  9  1983     4
## 10  1984    10
## # … with 36 more rows</code></pre>
<p>Let’s now talk about how to use <code>"ggplot2"</code> functions to obtain a data
visualization of the above frequencies.</p>
<div id="barcharts" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">13.1</span> Barcharts<a href="visualizing-number-of-systems.html#barcharts" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In chapter 4, we created a basic barchart of all <code>year</code> values. To be more
precise, we obtained a barchart based on all the entries for each given year
by invoking the command shown below:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="visualizing-number-of-systems.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># from chapter 4: barchart of year values</span></span>
<span id="cb3-2"><a href="visualizing-number-of-systems.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> storms) <span class="sc">+</span> </span>
<span id="cb3-3"><a href="visualizing-number-of-systems.html#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> year))</span></code></pre></div>
<p><img src="R-tidy-hurricanes_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>As you can tell, the <em>geometric object</em> (geom) function that is used in this
case is <code>geom_bar()</code>. This function, by default, does its own computation—via
<code>stat_count()</code>—to get the counts or frequencies.</p>
<div id="barchart-with-geom_bar" class="section level3 hasAnchor" number="13.1.1">
<h3><span class="header-section-number">13.1.1</span> Barchart with <code>geom_bar()</code><a href="visualizing-number-of-systems.html#barchart-with-geom_bar" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It feels very tempting and natural to use the same <code>"ggplot2"</code> functions of
the preceding command in order to create a bar-plot for the number of tropical
systems in each year. After all, this is exactly the type of chart we want to
produce. So why not using <code>geom_bar()</code>? Let’s try this out.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="visualizing-number-of-systems.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># doesn&#39;t work as expected</span></span>
<span id="cb4-2"><a href="visualizing-number-of-systems.html#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> system_counts_per_year) <span class="sc">+</span> </span>
<span id="cb4-3"><a href="visualizing-number-of-systems.html#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> year))</span></code></pre></div>
<p><img src="R-tidy-hurricanes_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Ooops!</p>
<p>What is going on with this graphic? Why do all bars have the same height? And
why the y-axis has a count scale from 0 to 1? This doesn’t make any sense.</p>
<p>Well, the explanation has to do with the technical fact that, as we just said,
by default <code>geom_bar()</code> does its own tally of <code>year</code> values.</p>
<p>Because the table <code>system_counts_per_year</code> already has the frequencies in
column <code>n</code>, we need to tell <code>geom_bar()</code> to not count anything. This is done
by adding a <code>y</code> argument to the aesthetic mapping function <code>aes()</code>, and also
by setting the argument <code>stat = "identity"</code></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="visualizing-number-of-systems.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this works</span></span>
<span id="cb5-2"><a href="visualizing-number-of-systems.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> system_counts_per_year) <span class="sc">+</span> </span>
<span id="cb5-3"><a href="visualizing-number-of-systems.html#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> n), <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>)</span></code></pre></div>
<p><img src="R-tidy-hurricanes_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="barchart-with-geom_col" class="section level3 hasAnchor" number="13.1.2">
<h3><span class="header-section-number">13.1.2</span> Barchart with <code>geom_col()</code><a href="visualizing-number-of-systems.html#barchart-with-geom_col" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Often, there is more than one way to obtain a given output or a given graphic.
Interestingly, in this case we can also get a barchart with the <code>geom_col()</code>
function. This is a sibling function of <code>geom_bar(stat = "identity")</code>, designed
to be used for tables of frequencies, like <code>system_counts_per_year</code>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="visualizing-number-of-systems.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># another way to get a barchart, given a table of frequencies</span></span>
<span id="cb6-2"><a href="visualizing-number-of-systems.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> system_counts_per_year) <span class="sc">+</span></span>
<span id="cb6-3"><a href="visualizing-number-of-systems.html#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> n))</span></code></pre></div>
<p><img src="R-tidy-hurricanes_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Looking at the chart, there are some fairly tall bars. Although it’s hard
to see exactly which years have a considerably large number of tropical systems,
eyeballing things out it seems that around 1995, 2005, and 2020 there are
20 or more storms. We can find the actual answer by using <code>arrange()</code>,
specifying the counts to be shown in descending order—with <code>desc()</code>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="visualizing-number-of-systems.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(system_counts_per_year, <span class="fu">desc</span>(n))</span></code></pre></div>
<pre><code>## # A tibble: 46 × 2
##     year     n
##    &lt;dbl&gt; &lt;int&gt;
##  1  2020    26
##  2  1995    21
##  3  2005    21
##  4  2003    20
##  5  2010    20
##  6  2019    18
##  7  2001    17
##  8  2012    17
##  9  2000    16
## 10  2007    16
## # … with 36 more rows</code></pre>
<p>As you can tell, in the 45-year period from 1975 to 2020, the top three years
by number of systems correspond to 2020, 1995 and 2005.</p>
</div>
</div>
<div id="customizing-a-barchart" class="section level2 hasAnchor" number="13.2">
<h2><span class="header-section-number">13.2</span> Customizing a Barchart<a href="visualizing-number-of-systems.html#customizing-a-barchart" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For illustration purposes, let’s further customize the bar plot by adding a
title, a more descriptive y-axis label, a simple background theme, and things
like that. For instance, the function <code>labs()</code> can be used to customize a
<code>title</code>, a <code>subtitle</code>, as well as axis labels. Likewise, the <code>theme_minimal()</code>
function provides a simplified background theme that, in my opinion, gives a
neat look to the graphic.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="visualizing-number-of-systems.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> system_counts_per_year) <span class="sc">+</span></span>
<span id="cb9-2"><a href="visualizing-number-of-systems.html#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb9-3"><a href="visualizing-number-of-systems.html#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of tropical systems per year&quot;</span>,</span>
<span id="cb9-4"><a href="visualizing-number-of-systems.html#cb9-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;(1975-2020)&quot;</span>,</span>
<span id="cb9-5"><a href="visualizing-number-of-systems.html#cb9-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;count&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-6"><a href="visualizing-number-of-systems.html#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="R-tidy-hurricanes_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div id="global-versus-local-aesthetic-mappings" class="section level3 hasAnchor" number="13.2.1">
<h3><span class="header-section-number">13.2.1</span> Global versus Local Aesthetic Mappings<a href="visualizing-number-of-systems.html#global-versus-local-aesthetic-mappings" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An equivalent way to get the above plot can be obtained if we move the mapping
<code>aes()</code> inside <code>ggplot()</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="visualizing-number-of-systems.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> system_counts_per_year, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="visualizing-number-of-systems.html#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb10-3"><a href="visualizing-number-of-systems.html#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of tropical systems per year&quot;</span>,</span>
<span id="cb10-4"><a href="visualizing-number-of-systems.html#cb10-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;(1975-2020)&quot;</span>,</span>
<span id="cb10-5"><a href="visualizing-number-of-systems.html#cb10-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;count&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-6"><a href="visualizing-number-of-systems.html#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p>Relocating the mapping command <code>aes()</code> may seem a bit whimsical. What difference
it makes if we place <code>aes()</code> inside <code>ggplot()</code> versus if we place it inside
<code>geom_col()</code>? It turns out that there is an important difference. Any mapping
done at the level of <code>ggplot()</code> is considered to be a <em>global</em> mapping in the
sense that this cascades down to any additional layer, such as <code>geom_col()</code>.
In contrast, any mapping done at the level of a <code>geom_...()</code> function or any
other layer function acts as a <em>local</em> mapping, only affecting that particular
type of geometric object.</p>
<p>To further illustrate the effect of <code>aes()</code>, let’s add a smoother to highlight
the increasing trend that the number of storms have experienced in the
visualized period of time. To do this, we add a new layer using <code>stat_smooth()</code>
with arguments <code>method = "loess"</code> and <code>se = FALSE</code></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="visualizing-number-of-systems.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> system_counts_per_year, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb11-2"><a href="visualizing-number-of-systems.html#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">&quot;gray50&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-3"><a href="visualizing-number-of-systems.html#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb11-4"><a href="visualizing-number-of-systems.html#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of tropical systems per year&quot;</span>,</span>
<span id="cb11-5"><a href="visualizing-number-of-systems.html#cb11-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;(1975-2020)&quot;</span>,</span>
<span id="cb11-6"><a href="visualizing-number-of-systems.html#cb11-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;count&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-7"><a href="visualizing-number-of-systems.html#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="R-tidy-hurricanes_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>The argument <code>method = "loess"</code> uses a non-linear smoother; in turn,
<code>se = FALSE</code> prevents the <em>standard error</em> ribbon from being plotted.
Observe also that the <code>fill</code> color of the bars has been changed to a less
darker gray in order to better distinguish the blue smoother.</p>
<p>Compare the above command with the following one in which the aesthetic
mapping <code>aes(x = year, y = n)</code> is done at the <code>geom_col()</code> level:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="visualizing-number-of-systems.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># error</span></span>
<span id="cb12-2"><a href="visualizing-number-of-systems.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> system_counts_per_year) <span class="sc">+</span></span>
<span id="cb12-3"><a href="visualizing-number-of-systems.html#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> n), <span class="at">fill =</span> <span class="st">&quot;gray50&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-4"><a href="visualizing-number-of-systems.html#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb12-5"><a href="visualizing-number-of-systems.html#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of tropical systems per year&quot;</span>,</span>
<span id="cb12-6"><a href="visualizing-number-of-systems.html#cb12-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;(1975-2020)&quot;</span>,</span>
<span id="cb12-7"><a href="visualizing-number-of-systems.html#cb12-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;count&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-8"><a href="visualizing-number-of-systems.html#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Error in `check_required_aesthetics()`:
## ! stat_smooth requires the following missing aesthetics: x and y</code></pre>
<p>Oh no! Houston, we have a problem.</p>
<p>Every time you get an error message, do the following two things:</p>
<ol style="list-style-type: decimal">
<li><p>First, don’t panic,</p></li>
<li><p>Second, read the error message.</p></li>
</ol>
<p>As you can tell, the error indicates that <code>stat_smooth()</code> requires missing
aesthetics: x and y.</p>
<p>You may argue that those statistics, x and y, are already specified in <code>aes()</code>,
inside <code>geom_col()</code>. And you are correct. But this is precisely the issue.
Those aesthetics only work for <code>geom_col()</code>, not for <code>stat_smooth()</code>. One
option to fix this problem is by including the same mapping into <code>stat_smooth()</code></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="visualizing-number-of-systems.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fixing the error</span></span>
<span id="cb15-2"><a href="visualizing-number-of-systems.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> system_counts_per_year) <span class="sc">+</span></span>
<span id="cb15-3"><a href="visualizing-number-of-systems.html#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> n), <span class="at">fill =</span> <span class="st">&quot;gray50&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-4"><a href="visualizing-number-of-systems.html#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> n), <span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb15-5"><a href="visualizing-number-of-systems.html#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of tropical systems per year&quot;</span>,</span>
<span id="cb15-6"><a href="visualizing-number-of-systems.html#cb15-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;(1975-2020)&quot;</span>,</span>
<span id="cb15-7"><a href="visualizing-number-of-systems.html#cb15-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;count&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-8"><a href="visualizing-number-of-systems.html#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p>While this fixes the problem, we’ve introduced unnecessary duplication into our
code. Why? Because the mapping command <code>aes(x = year, y = n)</code> appears in two
different places. A better option is to simply use one call to <code>aes()</code> at the
top <code>ggplot()</code>level. In this form the mapping propagates to both <code>geom_col()</code>
and <code>stat_smooth()</code></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="visualizing-number-of-systems.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># getting rid of the duplicated piece of code</span></span>
<span id="cb16-2"><a href="visualizing-number-of-systems.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> system_counts_per_year, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb16-3"><a href="visualizing-number-of-systems.html#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">&quot;gray50&quot;</span>) <span class="sc">+</span></span>
<span id="cb16-4"><a href="visualizing-number-of-systems.html#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb16-5"><a href="visualizing-number-of-systems.html#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of tropical systems per year&quot;</span>,</span>
<span id="cb16-6"><a href="visualizing-number-of-systems.html#cb16-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;(1975-2020)&quot;</span>,</span>
<span id="cb16-7"><a href="visualizing-number-of-systems.html#cb16-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;count&quot;</span>) <span class="sc">+</span></span>
<span id="cb16-8"><a href="visualizing-number-of-systems.html#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="counting-tropical-systems.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["R-tidy-hurricanes.pdf", "R-tidy-hurricanes.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
